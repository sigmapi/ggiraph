var ggiraphjs=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=d3},function(t,e,n){"use strict";var i;!function(){var n=void 0!==e&&e||{}||this||window;void 0===(i=function(){return n}.apply(e,[]))||(t.exports=i);var r="http://www.w3.org/2000/xmlns/",o=/url\(["']?(.+?)["']?\)/,s={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},a=function(t){if(!function(t){return t instanceof HTMLElement||t instanceof SVGElement}(t))throw new Error("an HTMLElement or SVGElement is required; got "+t)},l=function(t,e,n){var i=t.viewBox&&t.viewBox.baseVal&&t.viewBox.baseVal[n]||null!==e.getAttribute(n)&&!e.getAttribute(n).match(/%$/)&&parseInt(e.getAttribute(n))||t.getBoundingClientRect()[n]||parseInt(e.style[n])||parseInt(window.getComputedStyle(t).getPropertyValue(n));return void 0===i||null===i||isNaN(parseFloat(i))?0:i},c=function(t){for(var e=window.atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),r=new Uint8Array(i),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return new Blob([i],{type:n})},u=function(t,e){var n=t.cssText.match(o),i=n&&n[1]||"";if(i&&!i.match(/^data:/)&&"about:blank"!==i){var r=i.startsWith("../")?e+"/../"+i:i.startsWith("./")?e+"/."+i:i;return{text:t.cssText,format:function(t){var e=Object.keys(s).filter(function(e){return t.indexOf("."+e)>0}).map(function(t){return s[t]});return e?e[0]:(console.error("Unknown font format for "+t+". Fonts may not be working correctly."),"application/octet-stream")}(r),url:r}}},h=function(t){return Promise.all(Array.from(t.querySelectorAll("image")).map(function(t){var e=t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("href");return e?(function(t){return t&&0===t.lastIndexOf("http",0)&&-1===t.lastIndexOf(window.location.host)}(e)&&(e+=(-1===e.indexOf("?")?"?":"&")+"t="+(new Date).valueOf()),new Promise(function(n,i){var r=document.createElement("canvas"),o=new Image;o.crossOrigin="anonymous",o.src=e,o.onerror=function(){return i(new Error("Could not load "+e))},o.onload=function(){r.width=o.width,r.height=o.height,r.getContext("2d").drawImage(o,0,0),t.setAttributeNS("http://www.w3.org/1999/xlink","href",r.toDataURL("image/png")),n(!0)}})):Promise.resolve(null)}))},d={},f=function(t){return Promise.all(t.map(function(t){return new Promise(function(e,n){if(d[t.url])return e(d[t.url]);var i=new XMLHttpRequest;i.addEventListener("load",function(){var n=function(t){for(var e="",n=new Uint8Array(t),i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}(i.response),r=t.text.replace(o,'url("data:'+t.format+";base64,"+n+'")')+"\n";d[t.url]=r,e(r)}),i.addEventListener("error",function(n){console.warn("Failed to load font from: "+t.url,n),d[t.url]=null,e(null)}),i.addEventListener("abort",function(n){console.warn("Aborted loading font from: "+t.url,n),e(null)}),i.open("GET",t.url),i.responseType="arraybuffer",i.send()})})).then(function(t){return t.filter(function(t){return t}).join("")})},v=null,p=function(t,e){var n=e||{},i=n.selectorRemap,r=n.modifyStyle,o=n.modifyCss,s=n.fonts,a=o||function(t,e){return(i?i(t):t)+"{"+(r?r(e):e)+"}\n"},l=[],c=void 0===s,h=s||[];return(v||(v=Array.from(document.styleSheets).map(function(t){try{return{rules:t.cssRules,href:t.href}}catch(e){return console.warn("Stylesheet could not be loaded: "+t.href,e),{}}}))).forEach(function(e){var n=e.rules,i=e.href;n&&Array.from(n).forEach(function(e){if(void 0!==e.style)if(function(t,e){if(e)try{return t.querySelector(e)||t.parentNode&&t.parentNode.querySelector(e)}catch(t){console.warn('Invalid CSS selector "'+e+'"',t)}}(t,e.selectorText))l.push(a(e.selectorText,e.style.cssText));else if(c&&e.cssText.match(/^@font-face/)){var n=u(e,i);n&&h.push(n)}else l.push(e.cssText)})}),f(h).then(function(t){return l.join("\n")+t})};n.prepareSvg=function(t,e,n){a(t);var i=e||{},o=i.left,s=void 0===o?0:o,c=i.top,u=void 0===c?0:c,d=i.width,f=i.height,v=i.scale,g=void 0===v?1:v,m=i.responsive,y=void 0!==m&&m;return h(t).then(function(){var i=t.cloneNode(!0),o=(e||{}).backgroundColor,a=void 0===o?"transparent":o;i.style.backgroundColor=a;var c=function(t,e,n,i){if("svg"===t.tagName)return{width:n||l(t,e,"width"),height:i||l(t,e,"height")};if(t.getBBox){var r=t.getBBox(),o=r.x,s=r.y;return{width:o+r.width,height:s+r.height}}}(t,i,d,f),h=c.width,v=c.height;if("svg"!==t.tagName){if(!t.getBBox)return void console.error("Attempted to render non-SVG element",t);i.setAttribute("transform",i.getAttribute("transform").replace(/translate\(.*?\)/,""));var m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.appendChild(i),i=m}return i.setAttribute("version","1.1"),i.setAttribute("viewBox",[s,u,h,v].join(" ")),i.getAttribute("xmlns")||i.setAttributeNS(r,"xmlns","http://www.w3.org/2000/svg"),i.getAttribute("xmlns:xlink")||i.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),y?(i.removeAttribute("width"),i.removeAttribute("height"),i.setAttribute("preserveAspectRatio","xMinYMin meet")):(i.setAttribute("width",h*g),i.setAttribute("height",v*g)),Array.from(i.querySelectorAll("foreignObject > *")).forEach(function(t){t.getAttribute("xmlns")||t.setAttributeNS(r,"xmlns","http://www.w3.org/1999/xhtml")}),p(t,e).then(function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML="<![CDATA[\n"+t+"\n]]>";var r=document.createElement("defs");r.appendChild(e),i.insertBefore(r,i.firstChild);var o=document.createElement("div");o.appendChild(i);var s=o.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if("function"!=typeof n)return{src:s,width:h,height:v};n(s,h,v)})})},n.svgAsDataUri=function(t,e,i){a(t);var r=n.prepareSvg(t,e).then(function(t){var e=t.src;return"data:image/svg+xml;base64,"+window.btoa(function(t){return decodeURIComponent(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){var n=String.fromCharCode("0x"+e);return"%"===n?"%25":n}))}('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e))});return"function"==typeof i?r.then(i):r},n.svgAsPngUri=function(t,e,i){a(t);var r=e||{},o=r.encoderType,s=void 0===o?"image/png":o,l=r.encoderOptions,c=void 0===l?.8:l,u=r.canvg,h=function(t){var e=t.src,n=t.width,r=t.height,o=document.createElement("canvas"),a=o.getContext("2d"),l=window.devicePixelRatio||1;o.width=n*l,o.height=r*l,o.style.width=o.width+"px",o.style.height=o.height+"px",a.setTransform(l,0,0,l,0,0),u?u(o,e):a.drawImage(e,0,0);var h=void 0;try{h=o.toDataURL(s,c)}catch(t){if("undefined"!=typeof SecurityError&&t instanceof SecurityError||"SecurityError"===t.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw t}return"function"==typeof i&&i(h),Promise.resolve(h)};return u?n.prepareSvg(t,e).then(h):n.svgAsDataUri(t,e).then(function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(h({src:i,width:i.width,height:i.height}))},i.onerror=function(){n("There was an error loading the data URI as an image on the following SVG\n"+window.atob(t.slice(26))+"Open the following link to see browser's diagnosis\n"+t)},i.src=t})})},n.download=function(t,e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(c(e),t);else{var n=document.createElement("a");if("download"in n){n.download=t,n.style.display="none",document.body.appendChild(n);try{var i=c(e),r=URL.createObjectURL(i);n.href=r,n.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(r)})}}catch(t){console.warn("This browser does not support object URLs. Falling back to string URL."),n.href=e}n.click(),document.body.removeChild(n)}else window.open(e,"_temp","menubar=no,toolbar=no,status=no")}},n.saveSvg=function(t,e,i){a(t),n.svgAsDataUri(t,i||{},function(t){return n.download(e,t)})},n.saveSvgAsPng=function(t,e,i){a(t),n.svgAsPngUri(t,i||{},function(t){return n.download(e,t)})}}()},function(t,e,n){t.exports=n(4)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(0);function r(){var t,e=navigator.userAgent,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===n[1]&&null!==(t=e.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n.join(" "))}function o(t){return t.constructor.toString().indexOf("Array")>-1}var s=n(1);function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(e,n,i,r,o,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerid=e,this.svgid=n,this.clsName=i,this.position=r,this.zoomHandler=o,this.selectionHandler=s,this.saveaspng=a}return function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(t,[{key:"init",value:function(){if(!(this.zoomHandler||this.selectionHandler||this.saveaspng))return!1;var t=i.select("#"+this.containerid+" .girafe_container_std").append("div").classed(this.clsName,!0).classed(this.clsName+"-"+this.position,!0),e=this;if(this.selectionHandler){var n=t.append("div").classed(this.clsName+"-block",!0).classed("shinyonly",!0);n.append("a").classed(this.clsName+"-icon",!0).classed("neutral",!0).attr("title","lasso selection").on("click",function(){e.selectionHandler.lasso(!0)}).html(c.lasso_on),n.append("a").classed(this.clsName+"-icon",!0).classed("drop",!0).attr("title","lasso selection").on("click",function(){e.selectionHandler.lasso(!1)}).html(c.lasso_off)}if(this.zoomHandler){var r=t.append("div").classed(this.clsName+"-block",!0);r.append("a").classed(this.clsName+"-icon",!0).classed("neutral",!0).attr("title","pan-zoom reset").on("click",function(){e.zoomHandler.zoomIdentity()}).html(c.pan_zoom_reset),r.append("a").classed(this.clsName+"-icon",!0).classed("neutral",!0).attr("title","activate pan-zoom").on("click",function(){e.zoomHandler.zoomOn()}).html(c.zoom_on),r.append("a").classed(this.clsName+"-icon",!0).classed("drop",!0).attr("title","deactivate pan-zoom").on("click",function(){e.zoomHandler.zoomOff()}).html(c.zoom_off)}this.saveaspng&&t.append("div").classed(this.clsName+"-block",!0).append("a").classed(this.clsName+"-icon",!0).classed("neutral",!0).attr("title","download png").on("click",function(){"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?s.saveSvgAsPng(document.getElementById(e.svgid),"diagram.png"):console.error("This navigator does not support Promises")}).html(c.save_as_png);var o=i.select("#"+this.containerid).node();return o.addEventListener("mouseover",this),o.addEventListener("mouseout",this),!0}},{key:"destroy",value:function(){var t=i.select("#"+this.containerid),e=t.select("."+this.clsName);try{t.node().removeEventListener("mouseover",this),t.node().removeEventListener("mouseout",this)}catch(t){console.error(t)}try{e.selectAll("."+this.clsName+"-icon").on("click",null)}catch(t){console.error(t)}e.remove()}},{key:"handleEvent",value:function(t){try{var e=i.select("#"+this.containerid).select("."+this.clsName);"mouseover"==t.type?e.transition().duration(200).style("opacity",.8):"mouseout"==t.type&&e.transition().duration(500).style("opacity",0)}catch(t){console.error(t)}}}]),t}(),c={lasso_on:"<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>",lasso_off:"<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>",pan_zoom_reset:"<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><polygon points='274,209.7 337.9,145.9 288,96 416,96 416,224 366.1,174.1 302.3,238 '/><polygon points='274,302.3 337.9,366.1 288,416 416,416 416,288 366.1,337.9 302.3,274'/><polygon points='238,302.3 174.1,366.1 224,416 96,416 96,288 145.9,337.9 209.7,274'/><polygon points='238,209.7 174.1,145.9 224,96 96,96 96,224 145.9,174.1 209.7,238'/></g><svg>",zoom_on:"<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/></g></svg>",zoom_off:"<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/><line y2='455' x2='0' y1='0' x1='416' stroke-width='30'/></g></svg>",save_as_png:"<svg width='15pt' height='15pt' viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'><g><polygon points='95 275 95 415 415 415 415 275 375 275 375 380 135 380 135 275'/><polygon points='220 30 220 250 150 175 150 245 250 345 350 245 350 175 280 250 280 30'/></g></svg>"};function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerid=e,this.svgid=n,this.min=i,this.max=r,this.zoomer=null}return function(t,e,n){e&&u(t.prototype,e),n&&u(t,n)}(t,[{key:"init",value:function(){return!(1===this.min&&this.max<=1)&&(this.zoomer=i.zoom().scaleExtent([this.min,this.max]),!0)}},{key:"destroy",value:function(){this.zoomOff(),this.zoomer=null}},{key:"zoomOn",value:function(){var t=this.svgid;i.select("#"+this.containerid).call(this.zoomer.on("zoom",function(){i.select("#"+t+" g").attr("transform",i.event.transform)}))}},{key:"zoomIdentity",value:function(){i.select("#"+this.containerid).call(this.zoomer.transform,i.zoomIdentity)}},{key:"zoomOff",value:function(){i.select("#"+this.containerid).call(this.zoomer.on("zoom",null))}}]),t}();function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(e,n,i,r,o,s,a,l,c,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svgid=e,this.clsName=n+"_"+this.svgid,this.opacity=i,this.offx=r,this.offy=o,this.usecursor=s,this.usefill=a,this.usestroke=l,this.delayover=c,this.delayout=u}return function(t,e,n){e&&d(t.prototype,e),n&&d(t,n)}(t,[{key:"init",value:function(){var t=i.select("#"+this.svgid).selectAll("*[title]");if(t.empty())return!1;i.select("."+this.clsName).empty()&&i.select("body").append("div").attr("class",this.clsName),i.select("."+this.clsName).style("position","absolute").style("opacity",0);var e=this;return t.each(function(){this.addEventListener("mouseover",e),this.addEventListener("mousemove",e),this.addEventListener("mouseout",e)}),!0}},{key:"destroy",value:function(){var t=this;try{i.select("#"+this.svgid).selectAll("*[title]").each(function(){this.removeEventListener("mouseover",t),this.removeEventListener("mousemove",t),this.removeEventListener("mouseout",t)})}catch(t){console.error(t)}i.select("."+this.clsName).remove()}},{key:"handleEvent",value:function(t){try{var e,n,r,o,s,a,l=i.select("."+this.clsName);"mouseover"==t.type?(this.usefill&&l.style("background-color",t.target.getAttribute("fill")),this.usestroke&&l.style("border-color",t.target.getAttribute("stroke")),l.html(t.target.getAttribute("title")),l.html(l.text()),s=l.node().getBoundingClientRect(),a=i.select("#"+this.svgid).node().parentNode.getBoundingClientRect(),this.usecursor?((r=(e=t.pageX+this.offx)+s.width-(a.x+a.width))>0&&(e-=r),(o=(n=t.pageY+this.offy)+s.height-(a.y+a.height+window.pageYOffset))>0&&(n-=o)):(e=this.offx+a.left,n=document.documentElement.scrollTop+a.y+this.offy),l.style("left",e+"px").style("top",n+"px").transition().duration(this.delayover).style("opacity",this.opacity)):"mousemove"==t.type?(s=l.node().getBoundingClientRect(),a=i.select("#"+this.svgid).node().parentNode.getBoundingClientRect(),this.usecursor?((r=(e=t.pageX+this.offx)+s.width-(a.x+a.width))>0&&(e-=r),(o=(n=t.pageY+this.offy)+s.height-(a.y+a.height+window.pageYOffset))>0&&(n-=o)):(e=this.offx+a.left,n=document.documentElement.scrollTop+a.y+this.offy),l.style("left",e+"px").style("top",n+"px")):"mouseout"==t.type&&l.transition().duration(this.delayout).style("opacity",0)}catch(t){console.error(t)}}}]),t}();function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svgid=e,this.clsName=n+"_"+e,this.attrName=i,this.dataHovered=[]}return function(t,e,n){e&&v(t.prototype,e),n&&v(t,n)}(t,[{key:"init",value:function(){var t=i.select("#"+this.svgid).selectAll("*["+this.attrName+"]");if(t.empty())return!1;var e=this;return t.each(function(){this.addEventListener("mouseover",e),this.addEventListener("mouseout",e)}),!0}},{key:"destroy",value:function(){var t=this;try{i.select("#"+this.svgid).selectAll("*["+this.attrName+"]").each(function(){this.removeEventListener("mouseover",t),this.removeEventListener("mouseout",t)})}catch(t){console.error(t)}this.dataHovered=[]}},{key:"handleEvent",value:function(t){try{"mouseover"==t.type?this.setHovered([t.target.getAttribute(this.attrName)]):"mouseout"==t.type&&this.setHovered([])}catch(t){console.error(t)}}},{key:"setHovered",value:function(t){this.dataHovered=t,this.refreshHovered()}},{key:"refreshHovered",value:function(){var t=i.select("#"+this.svgid);t.selectAll("*["+this.attrName+"]."+this.clsName).classed(this.clsName,!1);for(var e=0;e<this.dataHovered.length;e++)t.selectAll("*["+this.attrName+'="'+this.dataHovered[e]+'"]').classed(this.clsName,!0)}}]),t}();function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var m=function(){function t(e,n,i,r,o,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svgid=e,this.clsName=n+"_"+e,this.attrName=i,this.shinyInputId=r,this.shinyMessageId=o,this.type=s,this.initialSelection=a,this.dataSelected=[]}return function(t,e,n){e&&g(t.prototype,e),n&&g(t,n)}(t,[{key:"init",value:function(){var t=i.select("#"+this.svgid).selectAll("*["+this.attrName+"]");if(t.empty()||"single"!=this.type&&"multiple"!=this.type)return!1;var e=this;return t.each(function(){this.addEventListener("click",e)}),this.shinyMessageId&&Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){"string"==typeof t?e.setSelected([t]):o(t)&&e.setSelected(t)}),"string"==typeof this.initialSelection?this.setSelected([this.initialSelection]):o(this.initialSelection)&&"multiple"==this.type&&this.setSelected(this.initialSelection),this.initialSelection=null,!0}},{key:"destroy",value:function(){var t=this;try{i.select("#"+this.svgid).selectAll("*["+this.attrName+"]").each(function(){this.removeEventListener("click",t)})}catch(t){console.error(t)}if(this.shinyMessageId)try{Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){})}catch(t){console.error(t)}this.dataSelected=[]}},{key:"handleEvent",value:function(t){try{var e=this.dataSelected,n=t.target.getAttribute(this.attrName),i=e.indexOf(n);"multiple"==this.type?i<0?e.push(n):e.splice(i,1):e=i<0?[n]:[],this.setSelected(e)}catch(t){console.error(t)}}},{key:"setSelected",value:function(t){this.dataSelected=t,this.refreshSelected(),this.shinyInputId&&Shiny.onInputChange(this.shinyInputId,this.dataSelected)}},{key:"refreshSelected",value:function(){var t=i.select("#"+this.svgid);t.selectAll("*["+this.attrName+"]."+this.clsName).classed(this.clsName,!1);for(var e=0;e<this.dataSelected.length;e++)t.selectAll("*["+this.attrName+'="'+this.dataSelected[e]+'"]').classed(this.clsName,!0)}},{key:"lasso",value:function(t){var e=i.select("#"+this.svgid),n=this,r=i.lasso();try{r=r.closePathSelect(!0).closePathDistance(100).items(e.selectAll("*["+this.attrName+"]")).targetArea(e).on("start",function(){}).on("draw",function(){}).on("end",function(){try{var i=n.dataSelected;r.selectedItems().each(function(e,r){var o=this.getAttribute(n.attrName),s=i.indexOf(o);s<0&&t?i.push(o):s>=0&&!t&&i.splice(s,1)}),e.on(".dragstart",null).on(".drag",null).on(".dragend",null),n.setSelected(i)}catch(t){console.error(t)}}),e.call(r)}catch(t){console.error(t)}}}]),t}();function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var w=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerid=e,this.svgid=null,this.handlers=[]}return function(t,e,n){e&&y(t.prototype,e),n&&y(t,n)}(t,[{key:"clear",value:function(){for(var t=0;t<this.handlers.length;t++)this.handlers[t].destroy();this.handlers=[],i.select("#"+this.containerid+" style").remove(),i.select("#"+this.containerid+" div.girafe_container_std").remove()}},{key:"setSvgId",value:function(t){this.svgid=t}},{key:"addStyle",value:function(t){var e=t.join("\n").replace(/SVGID_/g,this.svgid);i.select("#"+this.containerid).append("style").text(e)}},{key:"addSvg",value:function(t,e){(i.select("#"+this.containerid).append("div").attr("class","girafe_container_std").html(t),e)&&function(t){var e=t.indexOf("{"),n=t.substring(e+1,t.lastIndexOf("}")),i=t.substring(0,e),r=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(",");function o(){return Function.apply(this,r)}return r.push(n),o.prototype=Function.prototype,new o}(e)()}},{key:"IEFixResize",value:function(t,e){"IE 11"!=r()&&"MSIE"!==r().substring(0,4)||(i.select("#"+this.svgid).classed("girafe_svg_ie",!0),i.select("#"+this.containerid+" div").classed("girafe_container_ie",!0).style("width",Math.round(100*t)+"%").style("padding-bottom",Math.round(t*e*100)+"%"))}},{key:"autoScale",value:function(t){i.select("#"+this.svgid).style("width",t).style("height","100%").style("margin-left","auto").style("margin-right","auto")}},{key:"fixSize",value:function(t,e){i.select("#"+this.svgid).attr("preserveAspectRatio","xMidYMin meet"),i.select("#"+this.containerid+" .girafe_container_std").style("width","100%"),i.select("#"+this.svgid).attr("width",t).attr("height",e),i.select("#"+this.svgid).style("width",t).style("height",e)}},{key:"setSizeLimits",value:function(t,e,n,r){i.select("#"+this.svgid).style("max-width",t).style("max-height",n).style("min-width",e).style("min-height",r)}},{key:"removeContainerLimits",value:function(){"IE 11"==r()||"MSIE"===r().substring(0,4)||i.select("#"+this.containerid).style("width",null).style("height",null)}},{key:"setupTooltip",value:function(t,e,n,i,r,o,s,a,l){try{var c=new f(this.svgid,t,e,n,i,r,o,s,a,l);c.init()&&this.handlers.push(c)}catch(t){console.error(t)}}},{key:"setupHover",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];try{var i=new p(this.svgid,n.classPrefix,n.attrName);i.init()&&this.handlers.push(i)}catch(t){console.error(t)}}}},{key:"setupSelection",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n];try{if((e||!i.only_shiny)&&("single"==i.type||"multiple"==i.type)){var r=e?this.containerid+i.inputSuffix:null,o=e?this.containerid+i.messageSuffix:null,s=new m(this.svgid,i.classPrefix,i.attrName,r,o,i.type,i.selected);s.init()&&this.handlers.push(s)}}catch(t){console.error(t)}}}},{key:"setupZoom",value:function(t,e){try{var n=new h(this.containerid,this.svgid,t,e);n.init()&&this.handlers.push(n)}catch(t){console.error(t)}}},{key:"setupToolbar",value:function(t,e,n){try{for(var i=null,r=null,o=0;o<this.handlers.length;o++){var s=this.handlers[o];s instanceof h?i=s:s instanceof m&&"data-id"==s.attrName&&"multiple"==s.type&&(r=s)}var a=new l(this.containerid,this.svgid,t,e,i,r,n);a.init()&&this.handlers.push(a)}catch(t){console.error(t)}}}]),t}();n(3);function b(t){return new w(t)}n.d(e,"newgi",function(){return b})}]);